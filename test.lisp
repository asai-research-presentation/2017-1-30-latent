
(ql:quickload :bit-ops)
(in-package :bit-ops)

(as-bitwise-operations ()
  (ior (and a b)
       (and (not a) c)))

(as-bitwise-operations ()
  (full-adder-sum (subseq a 1)
                  (subseq b 1)
                  (half-adder-carry a b)))


(define-bitwise-operation multi-adder-sum (a b n)
  (if (zerop n)
      `(half-adder-sum ,a ,b)
      `(full-adder-sum (subseq ,a ,n)
                       (subseq ,b ,n)
                       (multi-adder-carry ,a ,b ,(1- n)))))


(define-bitwise-operation multi-adder-carry (a b n)
  (if (zerop n)
      `(half-adder-carry ,a ,b)
      `(full-adder-carry (subseq ,a ,n)
                         (subseq ,b ,n)
                         (multi-adder-carry ,a ,b ,(1- n)))))

(as-bitwise-operations ()
  (multi-adder-sum a b 5))



(LET* ((#:*LENGTH-VARIABLE*727 (LENGTH B))
       (#:G764 (MAKE-BIT-VECTOR #:*LENGTH-VARIABLE*727)))
  (DLET* ((#:G729 (MAKE-BIT-VECTOR #:*LENGTH-VARIABLE*727))
          (#:G728 (MAKE-BIT-VECTOR #:*LENGTH-VARIABLE*727))
          (#:G731 (MAKE-BIT-VECTOR #:*LENGTH-VARIABLE*727))
          (#:G732 (MAKE-BIT-VECTOR #:*LENGTH-VARIABLE*727))
          (#:G737 (MAKE-BIT-VECTOR #:*LENGTH-VARIABLE*727))
          (#:G738 (MAKE-BIT-VECTOR #:*LENGTH-VARIABLE*727))
          (#:G743 (MAKE-BIT-VECTOR #:*LENGTH-VARIABLE*727))
          (#:G744 (MAKE-BIT-VECTOR #:*LENGTH-VARIABLE*727))
          (#:G749 (MAKE-BIT-VECTOR #:*LENGTH-VARIABLE*727))
          (#:G750 (MAKE-BIT-VECTOR #:*LENGTH-VARIABLE*727))
          (#:G755 (MAKE-BIT-VECTOR #:*LENGTH-VARIABLE*727))
          (#:G754 (MAKE-BIT-VECTOR #:*LENGTH-VARIABLE*727))
          (#:G751 (MAKE-BIT-VECTOR #:*LENGTH-VARIABLE*727))
          (#:G748 (MAKE-BIT-VECTOR #:*LENGTH-VARIABLE*727))
          (#:G745 (MAKE-BIT-VECTOR #:*LENGTH-VARIABLE*727))
          (#:G742 (MAKE-BIT-VECTOR #:*LENGTH-VARIABLE*727))
          (#:G739 (MAKE-BIT-VECTOR #:*LENGTH-VARIABLE*727))
          (#:G736 (MAKE-BIT-VECTOR #:*LENGTH-VARIABLE*727))
          (#:G733 (MAKE-BIT-VECTOR #:*LENGTH-VARIABLE*727)))
    (BIT-REPLACE A 5 #:G728)
    (BIT-REPLACE B 5 #:G729)
    (BIT-XOR #:G728 #:G729 #:G728)
    (BIT-REPLACE A 4 #:G731)
    (BIT-REPLACE B 4 #:G732)
    (BIT-AND #:G731 #:G732 #:G733)
    (BIT-XOR #:G731 #:G732 #:G736)
    (BIT-REPLACE A 3 #:G737)
    (BIT-REPLACE B 3 #:G738)
    (BIT-AND #:G737 #:G738 #:G739)
    (BIT-XOR #:G737 #:G738 #:G742)
    (BIT-REPLACE A 2 #:G743)
    (BIT-REPLACE B 2 #:G744)
    (BIT-AND #:G743 #:G744 #:G745)
    (BIT-XOR #:G743 #:G744 #:G748)
    (BIT-REPLACE A 1 #:G749)
    (BIT-REPLACE B 1 #:G750)
    (BIT-AND #:G749 #:G750 #:G751)
    (BIT-XOR #:G749 #:G750 #:G754)
    (BIT-AND A B #:G755)
    (BIT-AND #:G754 #:G755 #:G754)
    (BIT-IOR #:G751 #:G754 #:G751)
    (BIT-AND #:G748 #:G751 #:G748)
    (BIT-IOR #:G745 #:G748 #:G745)
    (BIT-AND #:G742 #:G745 #:G742)
    (BIT-IOR #:G739 #:G742 #:G739)
    (BIT-AND #:G736 #:G739 #:G736)
    (BIT-IOR #:G733 #:G736 #:G733)
    (BIT-XOR #:G728 #:G733 #:G764)
    #:G764))
